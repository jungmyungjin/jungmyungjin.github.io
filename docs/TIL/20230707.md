layout: default
title: 20230707
parent: Today I Learned

# Today list : íšŒì› ê°€ì… 2

### express-validator `check` í•¨ìˆ˜

- express-validator ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì¼ë¶€ë¡œ, **Express ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì˜ ë¯¸ë“¤ì›¨ì–´ë¡œ ì‘ë™í•˜ë„ë¡ ì„¤ê³„** ë˜ì—ˆë‹¤.
    
    - ë”°ë¼ì„œ ì§ì ‘ í˜¸ì¶œí•˜ë ¤ê³  í•˜ë©´ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.
        
- `check` í•¨ìˆ˜ëŠ” íŠ¹ì • í•„ë“œì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì„¤ì •í•˜ëŠ” ë° ì‚¬ìš©ë˜ë©°, ì´ëŠ” Express ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ë¡œ ì „ë‹¬ë˜ì–´ ìš”ì²­ì˜ í•´ë‹¹ í•„ë“œë¥¼ ê²€ì‚¬í•˜ê²Œ ëœë‹¤.
    

**ì‚¬ìš© ë°©ë²•**

const { check } = require('express-validator');  
â€‹  
app.post('/user', [  
 Â // 'username' í•„ë“œë¥¼ ê²€ì‚¬í•˜ê³  ì‹¶ë‹¤ë©´ ì²« ë²ˆì§¸ ì¸ìë¡œ 'username'ì„ ë„˜ê¸´ë‹¤.  
 Â check('username')  
 Â  Â // isEmail() ë©”ì„œë“œë¥¼ ì²´ì´ë‹í•˜ì—¬ 'username' í•„ë“œê°€ ì´ë©”ì¼ í˜•ì‹ì¸ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  
 Â   .isEmail()  
 Â  Â // withMessage() ë©”ì„œë“œë¥¼ ì²´ì´ë‹í•˜ì—¬ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ ë°˜í™˜í•  ë©”ì‹œì§€ë¥¼ ì„¤ì •í•œë‹¤.  
 Â   .withMessage('Must be a valid email'),  
â€‹  
 Â // ë‹¤ìŒì€ 'password' í•„ë“œì— ëŒ€í•œ ê²€ì‚¬ë‹¤.  
 Â check('password')  
 Â   .isLength({ min: 8 })  
 Â   .withMessage('Must be at least 8 characters long'),  
 Â // ì•ì˜ ì²´ì´ë‹ëœ ë©”ì„œë“œë“¤ì„ í†µí•´ ì—¬ëŸ¬ ê°€ì§€ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤.  
â€‹  
  (req, res) => {  
 Â  Â // ìš”ì²­ ì²˜ë¦¬ ë¡œì§ì´ ì—¬ê¸°ì— ë“¤ì–´ê°„ë‹¤.  
  }  
]);  
â€‹

### ì—ëŸ¬ ì²˜ë¦¬, ì—ëŸ¬ í•¸ë“¤ëŸ¬, throw, next...

- javascriptëŠ” `throw`ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆì§€ë§Œ, ì´ëŠ” ì£¼ë¡œ ë™ê¸°ì ì¸ ì½”ë“œì—ì„œ ì‚¬ìš©ë˜ë©°, ë¹„ë™ê¸° ì½”ë“œì—ì„  ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤.
    
    - ì´ê²ƒì€ JavaScriptì˜ ë¹„ë™ê¸° íŠ¹ì„±ê³¼ ì´ë²¤íŠ¸ ë£¨í”„ì˜ ë™ì‘ ë°©ì‹ ë•Œë¬¸ì´ë‹¤.
        
- Express.jsì—ì„œëŠ” ëŒ€ë¶€ë¶„ì˜ ì½”ë“œê°€ ë¹„ë™ê¸°ì ìœ¼ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— ì—ëŸ¬ë¥¼ ì „ë‹¬ í•  ë•Œ `next`í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—ëŸ¬ë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
    

router.post('/user', validationPassword, async (req, res, next) => {  
 Â try {  
 Â  Â const user = await User.create(req.body);  
 Â  Â res.status(201).json(user);  
  } catch (err) {  
 Â  Â if (err instanceof ValidationError) {  
 Â  Â  Â res.status(400);  
 Â  Â  Â next(new Error('Invalid user data'));  
 Â   } else {  
 Â  Â  Â res.status(500);   
 Â  Â  Â next(err); Â // ì´ë ‡ê²Œ í•˜ë©´ nextê°€ í˜¸ì¶œë˜ëŠ” ìˆœê°„ Expressê°€ ì—ëŸ¬ë¥¼ ê°ì§€í•˜ê³ , í•´ë‹¹ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ë“±ë¡ëœ ì—ëŸ¬ì²˜ë¦¬ ë¯¸ë“¤ì›¨ì–´ë¥¼ í˜¸ì¶œí•œë‹¤  
â€‹  
 Â   }  
  }  
});  
â€‹

## ë¹„ë°€ë²ˆí˜¸ í•´ì‹±í•˜ê¸°

node.jsì—ì„œ ì¶”ì²œí•˜ëŠ” í•´ì‹± ë°©ë²•

- **bctypt**
    
    - ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ í•´ì‹œì˜ ë³µì¡ì„±ì„ ì¦ê°€ì‹œí‚¤ëŠ” ê¸°ëŠ¥ì„ í¬í•¨
        
        - ì´ëŠ” ë” ë§ì€ ê³„ì‚°ì„ í•„ìš”ë¡œ í•˜ëŠ” í•´ì‹œë¥¼ ìƒì„±í•˜ì—¬ ë¸Œë£¨íŠ¸ í¬ìŠ¤ ê³µê²©ì— ëŒ€í•œ ë³´í˜¸ë¥¼ í•œë‹¤.
            
    - ë ˆì¸ë³´ìš° í…Œì´ë¸” ê³µê²©ì— ëŒ€í•œ ë³´í˜¸ë¥¼ ì œê³µí•˜ëŠ” ì†”íŠ¸ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•˜ì—¬ ë§ì€ ê°œë°œìë“¤ì´ ì‚¬ìš©í•˜ê³  ê²€ì¦ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.
        
    - ë‹¨ì ìœ¼ë¡œëŠ”, ë‹¤ë¥¸ í•´ì‹± ë°©ë²•ì— ë¹„í•´ ìƒëŒ€ì ìœ¼ë¡œ ëŠë¦´ ìˆ˜ ìˆë‹¤.
        
    - `Node.js` í™˜ê²½ê²½ì—ì„œ ë” ì‰½ê²Œ ì„¤ì¹˜í•˜ê³  ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©° ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ê²€ì¦ë˜ì–´ ì™”ê¸° ë•Œë¬¸ì— ë” ë§ì´ ì„ íƒë˜ëŠ” í¸ì´ë‹¤.
        
- **argon2**
    
    - `bcrypt`ë³´ë‹¤ ë” ìµœì‹ ì˜ í•´ì‹± ì•Œê³ ë¦¬ì¦˜ì´ë©°, ì—¬ëŸ¬ ì½”ì–´ì™€ ë©”ëª¨ë¦¬ë¥¼ í™œìš©í•˜ì—¬ GPU ê¸°ë°˜ì˜ ê³µê²©ì— ëŒ€í•œ ë³´í˜¸ë¥¼ ì œê³µí•œë‹¤.
        
        - ì´ëŠ” `bcrypt`ê°€ ì œê³µí•˜ì§€ ëª»í•˜ëŠ” ì¤‘ìš”í•œ ë³´ì•ˆ ê¸°ëŠ¥ì´ë‹¤.
            
    - ì—¬ëŸ¬ ì•”í˜¸í™” ëŒ€íšŒì—ì„œ ìš°ìŠ¹í•œ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ, ë§ì€ ì „ë¬¸ê°€ë“¤ì´ ì¶”ì²œí•œë‹¤
        
    - ë‹¨ì ìœ¼ë¡œëŠ”, `bcrypt`ë³´ë‹¤ ì„¤ì¹˜ê°€ ì•½ê°„ ë” ë³µì¡í•  ìˆ˜ ìˆìœ¼ë©° `Node.js`ì—ì„œ ë„¤ì´í‹°ë¸Œ ë°”ì¸ë”©ì„ í•„ìš”ë¡œ í•œë‹¤.
        
        - ìƒëŒ€ì ìœ¼ë¡œ ìƒˆë¡­ê¸° ë•Œë¬¸ì— `bcrypt`ë§Œí¼ ë„ë¦¬ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.
            

> ìœ„ ë‘ ì•Œê³ ë¦¬ì¦˜ì€, ì•Œê³ ë¦¬ì¦˜ì€ ê³µê²©ì— ëŒ€í•œ ë‚´ì„±ì„ ì¦ê°€ì‹œí‚¤ëŠ” ì¶”ê°€ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. ë˜ ìë™ ì†”íŒ… ê¸°ëŠ¥ì„ ì œê³µí•˜ì—¬, ë‘ ì‚¬ìš©ìê°€ ë™ì¼í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ê°€ì§€ë”ë¼ë„ ë‹¤ë¥¸ í•´ì‹œê°’ì´ ìƒì„±ë˜ê²Œ í•˜ë©°, ì´ëŠ” ë ˆì¸ë³´ìš° í…Œì´ë¸” ê³µê²©ì— ëŒ€í•œ ë³´í˜¸ë¥¼ ì œê³µí•œë‹¤. bcryptì™€ argon2ëŠ” ëª¨ë‘ ê´‘ë²”ìœ„í•œ ì‚¬ìš© ì‚¬ë¡€ì™€ ê²€ì¦ì„ í†µí•´ ìì‹ ì˜ íš¨ìš©ì„±ì„ ì…ì¦í•œ ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤. ì´ê²ƒì€ ì´ëŸ¬í•œ í•´ì‹± ì•Œê³ ë¦¬ì¦˜ì˜ ì•ˆì •ì„±ê³¼ ì•ˆì „ì„±ì— ëŒ€í•œ í™•ì‹ ì„ ì œê³µí•œë‹¤.

**ê·¸ ì™¸..**

1. **MD5**: MD5ëŠ” ê°€ì¥ ì˜¤ë˜ëœ í•´ì‹œ ì•Œê³ ë¦¬ì¦˜ ì¤‘ í•˜ë‚˜ë¡œ, ë¹ ë¥´ê³  íš¨ìœ¨ì ì´ì§€ë§Œ ì•ˆì „ì„± ë¬¸ì œë¡œ ì¸í•´ í˜„ì¬ëŠ” ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. íŠ¹íˆ MD5ëŠ” ë ˆì¸ë³´ìš° í…Œì´ë¸” ê³µê²©ì— ì·¨ì•½í•˜ë©°, ì¶©ëŒ ê³µê²©ë„ ê°€ëŠ¥í•˜ì—¬ í•´ì‹œë¥¼ ë’¤ëŒë¦´ ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.
    
2. **SHA-1**: SHA-1ì€ MD5ë³´ë‹¤ëŠ” ì•ˆì „í•˜ì§€ë§Œ, 2005ë…„ ì´í›„ë¡œ ì—¬ëŸ¬ ë³´ì•ˆ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì–´ í˜„ì¬ëŠ” ì¶”ì²œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    
3. **SHA-256/SHA-512**: ì´ë“¤ì€ SHA-2 ê³„ì—´ì— ì†í•˜ëŠ” í•´ì‹œ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ, MD5 ë° SHA-1ì˜ ë³´ì•ˆ ì·¨ì•½ì ì„ í•´ê²°í•œ ë” ì•ˆì „í•œ ëŒ€ì•ˆì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ë“¤ ì•Œê³ ë¦¬ì¦˜ì€ ë¹„ë°€ë²ˆí˜¸ ì €ì¥ì— ì‚¬ìš©ë˜ê¸° ë³´ë‹¤ëŠ” íŒŒì¼ ë¬´ê²°ì„± ê²€ì¦ ë“±ì— ë” í”íˆ ì‚¬ìš©ë©ë‹ˆë‹¤.
    

### bcrypt : ë™ê¸°/ë¹„ë™ê¸° ë°©ì‹ì— ëŒ€í•œ ì°¨ì´

- bcrypt ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë™ê¸°/ë¹„ë™ê¸° ë°©ì‹ ì „ë¶€ ì§€ì›í•˜ê³  ìˆë‹¤.
    
- ë™ê¸°/ë¹„ë™ê¸° ë°©ì‹ì— ë”°ë¼ ì‚¬ìš©ë°©ì‹ì´ ì•½ê°„ ë‹¬ë¼ì§„ë‹¤.
    
- **ë¹„ë™ê¸°ì  ë°©ì‹ `bcrypt.hash()`**
    
    - ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³ , ì‘ì—…ì´ ì™„ë£Œë˜ë©´ ì½œë°±í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤
        
        - ì´ëŠ” Node.jsì˜ ì£¼ìš” ì¥ì  ì¤‘ í•˜ë‚˜ì¸ ë¹„ë™ê¸° I/Oë¥¼ í™œìš©í•˜ëŠ” ê²ƒì´ë©°, ì´ë¥¼ í†µí•´ Node.jsëŠ” ë‹¤ë¥¸ ìš”ì²­ì„ ë™ì‹œì— ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.
            
        - ì¦‰, ë¹„ë°€ë²ˆí˜¸ë¥¼ í•´ì‹±í•˜ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ìš”ì²­ì„ ê³„ì† ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.
            
    - ì½œë°± í•¨ìˆ˜ë¥¼ í•„ìš”ë¡œ í•˜ë¯€ë¡œ ì½”ë“œì˜ ë³µì¡ì„±ì„ ì¦ê°€ì‹œí‚¬ ìˆ˜ ìˆë‹¤.
        
- **ë™ê¸°ì  ë°©ì‹ `bcrypt.hashSync()`**
    
    - í˜¸ì¶œì´ ì™„ë£Œë  ë•Œê¹Œì§€ ì‹¤í–‰ì„ ë¸”ë¡í•œë‹¤.
        
        - í•´ë‹¹ ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ë‹¤ë¥¸ ìš”ì²­ì„ ì²˜ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
            
    - ì½”ë“œë¥¼ ë” ê°„ê²°í•˜ê²Œ ë§Œë“¤ì§€ë§Œ, Node.jsì˜ ë™ì‹œì„±ì„ í™œìš©í•˜ì§€ ëª»í•œë‹¤
        
    - _ë™ê¸°ì  í•¨ìˆ˜ëŠ” ì„œë²„ì˜ ì‘ë‹µì„±ì„ ì €í•˜ì‹œí‚¬ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì„±ëŠ¥ì´ ì¤‘ìš”í•œ ìƒí™©ì—ì„œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì„±ëŠ¥ì´ ì¤‘ìš”í•œ ìƒí™©ì—ì„œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë¹„ë™ê¸°ì  ë°©ì‹ì„ ì„ í˜¸í•œë‹¤._
        
- ë¹„ë°€ë²ˆí˜¸ í•´ì‹±ê³¼ ê°™ì€ CPUì§‘ì•½ì ì¸ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ê²½ìš°, ë¹„ë™ê¸°ì  ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¼ë°˜ì ìœ¼ë¡œ ì¢‹ë‹¤.
    
    - í•˜ì§€ë§Œ ë³µì¡ì„±ì´ ë¬¸ì œê°€ ë˜ëŠ” ê²½ìš°ì—ëŠ” ë™ê¸°ì  ë°©ì‹ì„ ì„ íƒí•  ìˆ˜ë„ ìˆë‹¤.
        

### bcrypt ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ì‹±í•˜ê¸°

#### code : ë¹„ë™ê¸°

const bcrypt = require('bcrypt');  
â€‹  
const saltRounds = 10;  
const myPlaintextPassword = 's0/\/\P4$$w0rD';  
â€‹  
bcrypt.hash(myPlaintextPassword, saltRounds, function(err, hash) {  
 Â // Store hash in your password DB.  
});  
â€‹  
â€‹

#### code : ë™ê¸°

const saltRounds = 10;  
const myPlaintextPassword = 's0/\/\P4$$w0rD';  
const salt = bcrypt.genSaltSync(saltRounds);  
const hash = bcrypt.hashSync(myPlaintextPassword, salt);  
â€‹  
// Store hash in your password DB.  
â€‹

- **`saltRounds`**
    
    - í•´ì‹± í”„ë¡œì„¸ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ëŠ” `salt`ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ ë°˜ë³µ íšŸìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
        
    - **salting**ì€ í•´ì‹œ ê³¼ì •ì—ì„œ ì¶”ê°€ ë°ì´í„°ë¥¼ ë”í•´ì„œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³´í˜¸í•˜ëŠ” ë°©ë²•ì´ë‹¤.
        
        - ì´ê²ƒì€ ê°™ì€ ë¹„ë°€ë²ˆí˜¸ê°€ í•­ìƒ ë™ì¼í•œ í•´ì‹œë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê³ , ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²© ë° ë ˆì¸ë³´ìš° í…Œì´ë¸” ê³µê²¨ê³ ê°€ ê°™ì€ ì¼ë°˜ì ì¸ ë¹„ë°€ë²ˆí˜¸ ê³µê²©ì— ëŒ€í•œ ë³´í˜¸ë¥¼ ì œê³µí•œë‹¤.
            
    - `saltRounds`ì˜ ê°’ì´ ë†’ì„ìˆ˜ë¡, í•´ì‹œë¥¼ ìƒì„±í•˜ëŠ” ë° ë” ë§ì€ ì‹œê°„ì´ ì†Œìš”ë˜ëŠ”ë°, ì¸ëŠ ë¬´ì°¨ë³„ ëŒ€ì…ê³µê²©ì„ ë”ìš± ì–´ë µê²Œ ë§Œë“ ë‹¤.
        
    - ê·¸ëŸ¬ë‚˜ `saltRounds`ì˜ ê°’ì´ ë„ˆë¬´ ë†’ì„ ê²½ìš°, ë¹„ë°€ë²ˆí˜¸ í•´ì‹±ì— ë„ˆë¬´ ë§ì€ ì‹œê°„ì´ ì†Œìš”ë˜ì–´ ì„œë²„ ì„±ëŠ¥ì— ë¶€ì •ì ì¸ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆë‹¤.
        
    - ë”°ë¼ì„œ `saltRounds`ëŠ” ë³´ì•ˆê³¼ ì„±ëŠ¥ ì‚¬ì´ì˜ ê· í˜•ì„ ì˜ ìœ ì§€í•˜ë©´ì„œ ì ì ˆí•œ ê°’ì„ ì„ íƒí•´ì•¼ í•œë‹¤.
        
    - _ì¼ë°˜ì ìœ¼ë¡œ `bcrypt`ì—ëŠ” 10-12 `saltRounds`ë¥¼ ì‚¬ìš©í•œë‹¤ê³  í•œë‹¤._
        

## ë¡œê·¸ì¸

ì‚¬ìš©ìì„œë²„ë°ì´í„°ë² ì´ìŠ¤íŒ¨ìŠ¤ì›Œë“œ ê²€ì¦bcryptëŠ” í•´ì‹œëœ íŒ¨ìŠ¤ì›Œë“œì—ì„œsaltë¥¼ ì¶”ì¶œí•˜ê³ , ì´ë¥¼ í‰ë¬¸ íŒ¨ìŠ¤ì›Œë“œì—ì ìš©í•˜ì—¬ í•´ì‹±. ì´í›„ ì›ë˜ í•´ì‹œëœíŒ¨ìŠ¤ì›Œë“œì™€ ë¹„êµë¡œê·¸ì¸ ìš”ì²­ (ì•„ì´ë””, í‰ë¬¸ íŒ¨ìŠ¤ì›Œë“œ)ì‚¬ìš©ì ê²€ìƒ‰ (ì•„ì´ë””ë¡œ)ì‚¬ìš©ì ì •ë³´ ì‘ë‹µ (í•´ì‹œëœ íŒ¨ìŠ¤ì›Œë“œ í¬í•¨)bcrypt.compare(í‰ë¬¸ íŒ¨ìŠ¤ì›Œë“œ, í•´ì‹œëœ íŒ¨ìŠ¤ì›Œë“œ)ì¸ì¦ ê²°ê³¼ ì‘ë‹µì‚¬ìš©ìì„œë²„ë°ì´í„°ë² ì´ìŠ¤

### ë¡œê·¸ì¸ : í•´ì‹±ëœ ê°’ì„ ì‚¬ìš©í•œ, ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸ í™•ì¸

> "ğŸ¤” íšŒì› ê°€ì… ì‹œ ì €ì¥í•œ íŒ¨ìŠ¤ì›Œë“œëŠ” saltë¡œ ëœë¤í•œ ê°’ì„ ì €ì¥í•œë‹¤ê³  í–ˆë‹¤.. ê°™ì€ íŒ¨ìŠ¤ì›Œë“œë¼ë„ saltë¥¼ ì‚¬ìš©í•˜ë©´ ê°ê¸° ë‹¤ë¥¸ hash ê°’ì´ ë‚˜ì˜¤ëŠ”ë°, íŒ¨ìŠ¤ì›Œë“œë¥¼ ì–´ë–»ê²Œ ë¹„êµí•˜ì§€..?"

#### **salt**

- 'salt'ëŠ” í•´ì‹œ ê³¼ì •ì—ì„œ ì‚¬ìš©ë˜ëŠ” ëœë¤í•œ ë°ì´í„°ì´ë©°, ì‹¤ì œë¡œ 'salt'ë¥¼ ì‚¬ìš©í•˜ë©´ ê°™ì€ íŒ¨ìŠ¤ì›Œë“œë¼ë„ ë‹¤ë¥¸ í•´ì‹œê°’ì„ ìƒì„±í•œë‹¤.
    
- 'salt'ë¥¼ ì‚¬ìš©í•˜ë©´ ê°™ì€ íŒ¨ìŠ¤ì›Œë“œë¼ë„ ë‹¤ë¥¸ í•´ì‹œ ê°’ì„ ìƒì„±í•œë‹¤. í•˜ì§€ë§Œ ì´ 'salt'ê°’ì€ í•´ì‹œëœ íŒ¨ìŠ¤ì›Œë“œì— í¬í•¨ë˜ì–´ ì €ì¥ëœë‹¤
    
    - ì´ëŸ° ë°©ì‹ìœ¼ë¡œ ê°™ì€ í‰ë¬¸ íŒ¨ìŠ¤ì›Œë“œë¼ë„ ê°ê° ë‹¤ë¥¸ ê°’ì„ ê°€ì§€ê²Œ ë˜ì–´ ë³´ì•ˆì„±ì„ ë†’ì´ëŠ” ë™ì‹œì—, ì›ë³¸ íŒ¨ìŠ¤ì›Œë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆê²Œ ëœë‹¤.
        
- **bcrypt** ì˜ `compare` í•¨ìˆ˜ëŠ” ì´ë¥¼ ì•Œê³  ìˆìœ¼ë©°, í•´ì‹œëœ íŒ¨ìŠ¤ì›Œë“œì—ì„œ 'salt'ì™€ í•¨ê»˜ í•´ì‹±í•œ ê²°ê³¼ê°€ ì €ì¥ëœí•´ì‹œê°’ê³¼ ë™ì¼í•˜ë‹¤ë©´, ì‚¬ìš©ìê°€ ì…ë ¥í•œ íŒ¨ìŠ¤ì›Œë“œê°€ ì›ë˜ íŒ¨ìŠ¤ì›Œë“œì™€ ì¼ì¹˜í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
    
- ë”°ë¼ì„œ 'salt'ë¥¼ ì‚¬ìš©í•´ë„ bcryptì˜ `compare`í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ë©´ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì˜¬ë°”ë¥´ê²Œ ê²€ì¦í•  ìˆ˜ ìˆë‹¤.
    

_ğŸ‘ê·¸ëŸ¼ bcryptì—ì„œ saltë¥¼ ì‚¬ìš©í•´ì„œ ëœë¤í•œ ê°’ì„ ì›ë˜ íŒ¨ìŠ¤ì›Œë“œë‘ í•©ì³ì„œ í•´ì‹±í•œë‹¤ëŠ” ê±°ê³ , ê·¸ ì•Œê³ ë¦¬ì¦˜ ë°©ì‹ì€ bcryptë§Œ ì•„ë‹ˆê¹Œ ê±°ê¸°ì„œ ì œê³µí•´ì¤€ compare í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ì•Œì•„ì„œ ê°™ì€ ì•”í˜¸ì¸ì§€ ì•„ë‹Œì§€ ì•Œë ¤ì£¼ëŠ” ê²ƒì´ë„¤..!!_

**code**

const bcrypt = require('bcrypt');  
// Compare the provided password with the hashed password in the database  
const match = await bcrypt.compare(password1, password2);  
if (!match) {  
  throw new Error('Invalid password');  
}

#### sequlizeë¡œ DB ì»¬ëŸ¼ ê°€ì ¸ì˜¤ê¸°

const foundUser = await findUser(email);  
â€‹  
foundUser.full_name // output : ëšœë¹„  
foundUser.dataValues.full_name //output : ëšœë¹„

##### _ğŸ¤”ê·¼ë° ê²°ê³¼ê°’ foundUserë¥¼ console.logë¡œ í™•ì¸í•´ë³´ë©´ ì´ë ‡ê²Œ ëœ¨ë˜ë°..?_

user {  
 Â dataValues: {  
 Â  Â id: 4,  
 Â  Â full_name: 'ëšœë¹„',  
 Â  Â email: 'user3@gmail.com',  
 Â  Â password: '$2b$10$lmrBY7N6XAav7sjPEhLmh..tQuSfi28kyZhOiAFALKLjWu7i7go6i',  
 Â  Â createdAt: 2023-07-07T04:41:28.000Z,  
 Â  Â updatedAt: 2023-07-07T04:41:28.000Z  
  },  
 Â _previousDataValues: {  
 Â  Â id: 4,  
 Â  Â full_name: 'ëšœë¹„',  
 Â  Â email: 'user3@gmail.com',  
 Â  Â password: '$2b$10$lmrBY7N6XAav7sjPEhLmh..tQuSfi28kyZhOiAFALKLjWu7i7go6i',  
 Â  Â createdAt: 2023-07-07T04:41:28.000Z,  
 Â  Â updatedAt: 2023-07-07T04:41:28.000Z  
  },  
 Â uniqno: 1,  
 Â _changed: Set(0) {},  
 Â _options: {  
 Â  Â isNewRecord: false,  
 Â  Â _schema: null,  
 Â  Â _schemaDelimiter: '',  
 Â  Â raw: true,  
 Â  Â attributes: [  
 Â  Â  Â 'id',  
 Â  Â  Â 'full_name',  
 Â  Â  Â 'email',  
 Â  Â  Â 'password',  
 Â  Â  Â 'createdAt',  
 Â  Â  Â 'updatedAt'  
 Â   ]  
  },  
 Â isNewRecord: false  
}

- Sequelizeì—ì„œ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ë©´, SequelizeëŠ” ê°ê°ì˜ ë°ì´í„° í•„ë“œë¥¼ JavaScriptì˜ ê°ì²´ì˜ ì†ì„±ìœ¼ë¡œ í‘œí˜„í•œë‹¤.
    
- ì´ ê°ì²´ëŠ” `.dataValues` ê°ì²´ë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆì§€ë§Œ, ì‹¤ì œë¡œëŠ” `.dataValues`ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì ‘ê·¼í•  í•„ìš”ì—†ì´ ë°”ë¡œ ì†ì„±ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.
    
- ì´ëŠ” Sequelizeê°€ ë‚´ë¶€ì ìœ¼ë¡œ `.dataValues`ì— ìˆëŠ” ê°’ì„ ì°¸ì¡°í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
    
    - `foundUser.email`ì„ ì‚¬ìš©í•˜ë©´ SequelizeëŠ” ë‚´ë¶€ì ìœ¼ë¡œ foundUser.dataValues.email`ì„ ì°¸ì¡°í•˜ê²Œ ëœë‹¤.
        

## jwt í† í° ìƒì„±

const jwt = require('jsonwebtoken');  
â€‹  
function generateAccessToken(username) {  
 Â // í˜ì´ë¡œë“œ  
 Â const payload = {  
 Â  Â username,  
 Â  Â createdAt: Date.now(),  
  };  
 Â   
 Â // ë¹„ë°€ í‚¤  
 Â const secret = 'yourSecretKey';  
â€‹  
 Â // í† í° ì˜µì…˜  
 Â const options = {  
 Â  Â expiresIn: '1h', Â // í† í°ì˜ ìœ íš¨ê¸°ê°„ ì„¤ì • (ì˜ˆ: 1ì‹œê°„)  
  };  
â€‹  
 Â // í† í° ìƒì„±  
 Â const token = jwt.sign(payload, secret, options);  
 Â   
 Â return token;  
}  
â€‹  
const token = generateAccessToken('testUser');  
console.log(token);  
â€‹

### ğŸ’¥ ë¬¸ì œ ë°œìƒ : index.jsë¡œ service í´ë”ë¥¼ ê´€ë¦¬í•˜ë˜ ì¤‘ ìˆœí™˜ì¢…ì†ì„± ë¬¸ì œ ë°œìƒ!!

#### ë¬¸ì œ ìƒí™©

1. **í˜„ì¬ íŒŒì¼ êµ¬ì¡°**
    

./services/  
â”œâ”€â”€ authService.js  
â”œâ”€â”€ index.js  
â”œâ”€â”€ taskService.js  
â””â”€â”€ userService.js

2. ìˆœí™˜ ì¢…ì†ì„± ë¬¸ì œ ë°œìƒ ë°°ê²½
    

> - `passwordHash`(ë¹„ë°€ë²ˆí˜¸ë¥¼ bcryptë¥¼ ì‚¬ìš©í•´ í•´ì‹œë¡œ ë§Œë“œëŠ” í•¨ìˆ˜)
>     
> - `generateAccessToken`(jwt í† í°ì„ ë§Œë“œëŠ” í•¨ìˆ˜) ìœ„ ë‘ í•¨ìˆ˜ë¥¼ `services` í´ë” ë‚´ë¶€ì˜ `authService.js` íŒŒì¼ ë‚´ë¶€ì— ìƒì„±í•˜ê³ , ì´ë¥¼ `index.js` ë¥¼ í†µí•´ `userService.js`ì—ì„œ ì‚¬ìš©í•˜ë ¤ê³  í•˜ë˜ ì¤‘ ë°œìƒ
>     

**index.js**

const taskService = require("./taskService");  
const userService = require("./userService");  
const authService = require("./authService");  
â€‹  
module.exports = {  
taskService,  
userService,  
authService,  
};

**userService.js**

const { check, validationResult } = require("express-validator");  
const bcrypt = require("bcrypt");  
const { User } = require("../models/index");  
const { authService } = require("./index");  
â€‹  
...  
â€‹  
const jwt = authService.generateAccessToken({  
email: foundUser.email,  
full_name: foundUser.full_name,  
});  
â€‹  
...

3. ìˆœí™˜ ì¢…ì†ì„± ë¬¸ì œ ë°œìƒ
    

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Â  Â  Â  Â  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  
â”‚ Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  â”‚  
â”‚ authService â”‚<--------â”‚ userService â”‚  
â”‚ Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  â”‚  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Â  Â  Â  Â  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  
 Â  Â   â–² Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â–²  
 Â  Â   â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Â  Â  Â  Â  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  
â”‚ Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  â”‚  
â”‚  index.js â”‚-------->â”‚  User.js  â”‚  
â”‚ Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  â”‚  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Â  Â  Â  Â  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  
â€‹

**ê·¸ë˜ì„œ...**

- `/utils` í´ë” í•˜ìœ„ì— íŒŒì¼ì„ ìƒì„±í•˜ë ¤ë‹¤ê°€, ë‚´ í”„ë¡œì íŠ¸ ì•ˆì—ì„  ë‹¤ë¥¸ ê³³ì—ì„œ ì´ í•¨ìˆ˜ë¥¼ ì“¸ ì¼ì´ ì „í˜€ ì—†ì–´ì„œ `/services` í•˜ìœ„ë¡œ ë‹¤ì‹œ ìˆ˜ì •í•˜ë˜ ì¤‘ ë°œìƒí–ˆë‹¤.
    
- **service ì—ì„œ serviceë¥¼ ë¶€ë¥´ëŠ” ì¼ì´ ë˜ ìƒê¸¸ ê°€ëŠ¥ì„±ì´ ìˆë‹¤ê³  ìƒê°í•˜ì—¬.. index.jsë¥¼ ì—†ì• ê¸°ë¡œ í–ˆë‹¤..ğŸ˜‚**